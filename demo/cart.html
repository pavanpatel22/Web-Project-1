<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart - TechGear Shop</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="../timeline-styles.css">
</head>

<body>
    <header>
        <nav>
            <div class="container nav-container">
                <a href="index.html" class="logo">TechGear</a>
                <div class="nav-links">
                    <a href="index.html">Home</a>
                    <a href="products.html">Products</a>
                    <a href="cart.html" class="cart-icon">
                        Cart <span class="cart-count">0</span>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container">
        <h1>Your Shopping Cart</h1>

        <!-- Cart Items Table -->
        <div id="cart-content">
            <table class="cart-table">
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Unit Price</th>
                        <th>Quantity</th>
                        <th>Subtotal</th>
                        <th>Remove</th>
                    </tr>
                </thead>
                <tbody id="cart-items">
                    <!-- Dynamic rows added here -->
                </tbody>
            </table>

            <div id="cart-summary">
                <h3>Total: $<span id="cart-total">0.00</span></h3>
            </div>
        </div>

        <!-- Checkout Form -->
        <form id="checkout-form" class="cart-form">
            <h2>Checkout</h2>

            <div class="form-group">
                <label for="fullName">Full Name</label>
                <input id="fullName" name="name" type="text" required>
            </div>

            <div class="form-group">
                <label for="userEmail">Email</label>
                <input id="userEmail" name="email" type="email" required>
            </div>

            <div class="form-group">
                <label for="shippingAddress">Shipping Address</label>
                <textarea id="shippingAddress" name="address" required></textarea>
            </div>

            <div class="form-group">
                <label for="contactNumber">Phone Number</label>
                <input id="contactNumber" name="phone" type="tel" required>
            </div>

            <button type="submit" class="btn btn-primary">Confirm Order</button>
        </form>
    </main>

    <!-- Activity Tracker + Cart Logic -->
    <script src="../activity-tracker.js"></script>
    <script src="cart.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            renderCart();
        });

        // Render the cart table dynamically
        function renderCart() {
            const cartData = cart.getCart();
            const tableBody = document.getElementById('cart-items');
            const totalPriceEl = document.getElementById('cart-total');

            tableBody.innerHTML = '';

            cartData.forEach(product => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="display:flex;align-items:center;gap:1rem;">
                            <img src="${product.image}" alt="${product.name}" 
                                 style="width:50px;height:50px;object-fit:cover;">
                            <span>${product.name}</span>
                        </div>
                    </td>
                    <td>$${product.price.toFixed(2)}</td>
                    <td>
                        <input type="number" min="0" value="${product.quantity}" 
                               onchange="adjustQty('${product.id}', this.value)">
                    </td>
                    <td>$${(product.price * product.quantity).toFixed(2)}</td>
                    <td>
                        <button class="btn btn-secondary" onclick="deleteItem('${product.id}')">Remove</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });

            totalPriceEl.textContent = cart.getTotal().toFixed(2);
        }

        // Adjust quantity of product
        function adjustQty(id, qty) {
            cart.updateQuantity(id, qty);
            renderCart();
        }

        // Delete item from cart
        function deleteItem(id) {
            cart.removeFromCart(id);
            renderCart();
        }

        // Checkout form handler
        document.getElementById('checkout-form').addEventListener('submit', event => {
            event.preventDefault();

            if (cart.getCart().length === 0) {
                alert('Your cart is empty!');
                return;
            }

            alert('Your order has been placed successfully! (Demo only)');
            cart.clearCart();
            renderCart();
        });
    </script>
</body>
</html>
